--Ê¹ÓÃÅä·½µÄ½Å±¾

--½Å±¾ºÅ
x338000_g_scriptId = 338000

x338000_g_SkillBooks = {}

-- ItemTable ºÅÎªË÷Òý

-- type: ÊéµÄÀàÐÍ£¬1 ±íÊ¾ÐÄ·¨£¬2 ±íÊ¾¼¼ÄÜ
-- menpaiId: Ñ§Ï°µÄ¶ÔÓ¦Åä·½ºÅ
-- MP_SHAOLIN	= 0
-- MP_MINGJIAO	= 1
-- MP_GAIBANG	= 2
-- MP_WUDANG	= 3
-- MP_EMEI		= 4
-- MP_XINGSU	= 5
-- MP_DALI		= 6
-- MP_TIANSHAN	= 7
-- MP_XIAOYAO	= 8
-- MP_WUMENPAI	= 9

-- needLevel: ÑÐ¶Á´ËÊéC¥n µÄÏàÓ¦ÈËÎïc¤p±ð£¬ -1 ±íÊ¾Ã»ÓÐÒªÇó
-- needXinfa: ÑÐ¶Á´ËÊéC¥n µÄÏàÓ¦ÐÄ·¨£¬ -1 ±íÊ¾Ã»ÓÐÒªÇó
-- needXinfaLevel: ÑÐ¶Á´ËÊéC¥n ÏàÓ¦ÐÄ·¨µÄµÈc¤p£¬ -1 ±íÊ¾Ã»ÓÐÒªÇó
-- specialEffectID: ÌØÐ§ºÅ

-- ÃÅÅÉÃû³Æ #{_MENPAI" .. menpaiid .. "}
-- ÎïÆ·Ãû³Æ #{_ITEM" .. itemid .. "}
-- ÐÄ·¨Ãû³Æ #{_XINFA" .. xinfaid .. "}
x338000_g_SkillBooks[30308002] = { type = 1, id = 55, menpaiId = MP_SHAOLIN, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308003] = { type = 1, id = 56, menpaiId = MP_MINGJIAO, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308004] = { type = 1, id = 57, menpaiId = MP_GAIBANG, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308005] = { type = 1, id = 58, menpaiId = MP_WUDANG, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308006] = { type = 1, id = 59, menpaiId = MP_EMEI, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308007] = { type = 1, id = 60, menpaiId = MP_XINGSU, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308008] = { type = 1, id = 61, menpaiId = MP_DALI, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308009] = { type = 1, id = 62, menpaiId = MP_TIANSHAN, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308010] = { type = 1, id = 63, menpaiId = MP_XIAOYAO, needLevel = 35, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308011] = { type = 2, id = 301, menpaiId = MP_SHAOLIN, needLevel = 65, needXinfa = 55, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308012] = { type = 2, id = 331, menpaiId = MP_MINGJIAO, needLevel = 65, needXinfa = 56, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308013] = { type = 2, id = 361, menpaiId = MP_GAIBANG, needLevel = 65, needXinfa = 57, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308014] = { type = 2, id = 391, menpaiId = MP_WUDANG, needLevel = 65, needXinfa = 58, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308015] = { type = 2, id = 421, menpaiId = MP_EMEI, needLevel = 65, needXinfa = 59, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308016] = { type = 2, id = 451, menpaiId = MP_XINGSU, needLevel = 65, needXinfa = 60, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308017] = { type = 2, id = 481, menpaiId = MP_DALI, needLevel = 65, needXinfa = 61, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308018] = { type = 2, id = 511, menpaiId = MP_TIANSHAN, needLevel = 65, needXinfa = 62, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308019] = { type = 2, id = 541, menpaiId = MP_XIAOYAO, needLevel = 65, needXinfa = 63, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308042] = { type = 2, id = 423, menpaiId = MP_EMEI, needLevel = 30, needXinfa = 27, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308043] = { type = 2, id = 424, menpaiId = MP_EMEI, needLevel = 45, needXinfa = 59, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308044] = { type = 2, id = 304, menpaiId = MP_SHAOLIN, needLevel = 30, needXinfa = 3, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308045] = { type = 2, id = 305, menpaiId = MP_SHAOLIN, needLevel = 45, needXinfa = 55, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308055] = { type = 2, id = 37, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = -1, specialEffectID = 18 }
x338000_g_SkillBooks[30308060] = { type = 2, id = 364, menpaiId = MP_GAIBANG, needLevel = 45, needXinfa = 57, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308066] = { type = 2, id = 394, menpaiId = MP_WUDANG, needLevel = 45, needXinfa = 58, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308067] = { type = 2, id = 454, menpaiId = MP_XINGSU, needLevel = 45, needXinfa = 60, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308068] = { type = 2, id = 487, menpaiId = MP_DALI, needLevel = 45, needXinfa = 61, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308069] = { type = 2, id = 544, menpaiId = MP_XIAOYAO, needLevel = 45, needXinfa = 63, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308070] = { type = 2, id = 334, menpaiId = MP_MINGJIAO, needLevel = 45, needXinfa = 56, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308071] = { type = 2, id = 515, menpaiId = MP_TIANSHAN, needLevel = 45, needXinfa = 62, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308082] = { type = 2, id = 306, menpaiId = MP_SHAOLIN, needLevel = 80, needXinfa = 55, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308083] = { type = 2, id = 488, menpaiId = MP_DALI, needLevel = 80, needXinfa = 61, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308087] = { type = 2, id = 395, menpaiId = MP_WUDANG, needLevel = 80, needXinfa = 58, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308088] = { type = 2, id = 455, menpaiId = MP_XINGSU, needLevel = 80, needXinfa = 60, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308089] = { type = 2, id = 365, menpaiId = MP_GAIBANG, needLevel = 80, needXinfa = 57, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308090] = { type = 2, id = 545, menpaiId = MP_XIAOYAO, needLevel = 80, needXinfa = 63, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308091] = { type = 2, id = 335, menpaiId = MP_MINGJIAO, needLevel = 80, needXinfa = 56, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308092] = { type = 2, id = 516, menpaiId = MP_TIANSHAN, needLevel = 80, needXinfa = 62, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308093] = { type = 2, id = 426, menpaiId = MP_EMEI, needLevel = 80, needXinfa = 59, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308101] = { type = 1, id = 72, menpaiId = MP_SHAOLIN, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308102] = { type = 1, id = 73, menpaiId = MP_MINGJIAO, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308103] = { type = 1, id = 74, menpaiId = MP_GAIBANG, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308104] = { type = 1, id = 75, menpaiId = MP_WUDANG, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308105] = { type = 1, id = 76, menpaiId = MP_EMEI, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308106] = { type = 1, id = 77, menpaiId = MP_XINGSU, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308107] = { type = 1, id = 78, menpaiId = MP_DALI, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308108] = { type = 1, id = 79, menpaiId = MP_TIANSHAN, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308109] = { type = 1, id = 80, menpaiId = MP_XIAOYAO, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308111] = { type = 2, id = 307, menpaiId = MP_SHAOLIN, needLevel = 80, needXinfa = 72, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308112] = { type = 2, id = 336, menpaiId = MP_MINGJIAO, needLevel = 80, needXinfa = 73, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308113] = { type = 2, id = 366, menpaiId = MP_GAIBANG, needLevel = 80, needXinfa = 74, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308114] = { type = 2, id = 396, menpaiId = MP_WUDANG, needLevel = 80, needXinfa = 75, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308115] = { type = 2, id = 427, menpaiId = MP_EMEI, needLevel = 80, needXinfa = 76, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308116] = { type = 2, id = 456, menpaiId = MP_XINGSU, needLevel = 80, needXinfa = 77, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308117] = { type = 2, id = 489, menpaiId = MP_DALI, needLevel = 80, needXinfa = 78, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308118] = { type = 2, id = 517, menpaiId = MP_TIANSHAN, needLevel = 80, needXinfa = 79, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308119] = { type = 2, id = 546, menpaiId = MP_XIAOYAO, needLevel = 80, needXinfa = 80, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308121] = { type = 2, id = 308, menpaiId = MP_SHAOLIN, needLevel = 80, needXinfa = 72, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308122] = { type = 2, id = 337, menpaiId = MP_MINGJIAO, needLevel = 80, needXinfa = 73, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308123] = { type = 2, id = 367, menpaiId = MP_GAIBANG, needLevel = 80, needXinfa = 74, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308124] = { type = 2, id = 397, menpaiId = MP_WUDANG, needLevel = 80, needXinfa = 75, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308125] = { type = 2, id = 428, menpaiId = MP_EMEI, needLevel = 80, needXinfa = 76, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308126] = { type = 2, id = 457, menpaiId = MP_XINGSU, needLevel = 80, needXinfa = 77, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308127] = { type = 2, id = 490, menpaiId = MP_DALI, needLevel = 80, needXinfa = 78, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308128] = { type = 2, id = 518, menpaiId = MP_TIANSHAN, needLevel = 80, needXinfa = 79, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308129] = { type = 2, id = 547, menpaiId = MP_XIAOYAO, needLevel = 80, needXinfa = 80, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308149] = { type = 2, id = 1652, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308150] = { type = 2, id = 1653, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308151] = { type = 2, id = 1654, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308152] = { type = 2, id = 1655, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308153] = { type = 2, id = 1657, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308154] = { type = 2, id = 1658, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308155] = { type = 2, id = 1659, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308156] = { type = 2, id = 1660, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308157] = { type = 2, id = 1662, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308158] = { type = 2, id = 1663, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308159] = { type = 2, id = 1664, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308160] = { type = 2, id = 1665, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308161] = { type = 2, id = 1667, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308162] = { type = 2, id = 1668, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308163] = { type = 2, id = 1669, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308164] = { type = 2, id = 1670, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308165] = { type = 2, id = 1671, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308166] = { type = 2, id = 1672, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308167] = { type = 2, id = 1673, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308168] = { type = 2, id = 1674, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308169] = { type = 2, id = 1675, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308170] = { type = 2, id = 1676, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308171] = { type = 2, id = 1677, menpaiId = -1, needLevel = 40, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308172] = { type = 2, id = 1678, menpaiId = -1, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308173] = { type = 2, id = 1679, menpaiId = -1, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308174] = { type = 2, id = 1680, menpaiId = -1, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }
x338000_g_SkillBooks[30308175] = { type = 2, id = 1681, menpaiId = -1, needLevel = 80, needXinfa = -1, needXinfaLevel = 1, specialEffectID = 18 }

x338000_g_TypeNames = {}
x338000_g_TypeNames[1] = "Bí T¸ch"
x338000_g_TypeNames[2] = "Yªu Quyªt"

--**********************************
-- ·µ»Ø1: ¼¼ÄÜÀàËÆµÄÎïÆ·£¬¿ÉÒÔ¼ÌÐøÀàËÆ¼¼ÄÜµÄÖ´ÐÐ£»·µ»Ø0: Ö´ÐÐ OnDefaultEvent.
--**********************************
function x338000_IsSkillLikeScript( sceneId, selfId )
	return 1
end

--**********************************
-- ·µ»Ø1: ÒÑ¾­HuÖ bö¶ÔÓ¦Ð§¹û£¬²»ÔÙÖ´ÐÐºóÐø²Ù×÷£»·µ»Ø0: Ã»ÓÐ¼ì²âµ½Ïà¹ØÐ§¹û£¬¼ÌÐøÖ´ÐÐ.
--**********************************
function x338000_CancelImpacts( sceneId, selfId )
	return 0
end

--**********************************
-- Ìõ¼þ¼ì²âÈë¿Ú: ·µ»Ø1: Ìõ¼þ¼ì²âÍ¨¹ý£¬¿ÉÒÔ¼ÌÐøÖ´ÐÐ£»·µ»Ø0: Ìõ¼þ¼ì²âÊ§°Ü£¬ÖÐ¶ÏºóÐøÖ´ÐÐ.
--**********************************
function x338000_OnConditionCheck( sceneId, selfId )
	-- Ð£ÑéÊ¹ÓÃµÄÎïÆ·
	if LuaFnVerifyUsedItem( sceneId, selfId ) ~= 1 then
		return 0
	end

	-- ÕÒµ½ÏàÓ¦ÌõÄ¿
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId )
	local skillBook = x338000_g_SkillBooks[itemTblIndex]
	if not skillBook then
		return 0
	end

	-- Èç¹ûÃÅÅÉ²»ÏàÍ¬
	local menpai = GetMenPai( sceneId, selfId )
	if -1~=skillBook.menpaiId then
	 if menpai ~= skillBook.menpaiId then
		 x338000_NotifyFailTips( sceneId, selfId, "Ngß½i không phäi là #{_MENPAI" .. skillBook.menpaiId .. "} ð® tØ, không th¬ h÷c ðßþc " .. x338000_g_TypeNames[skillBook.type] .. "." )
		 return 0
	 end
	end

	if GetLevel( sceneId, selfId ) < skillBook.needLevel then
		x338000_NotifyFailTips( sceneId, selfId, "Ngß½i vçn không th¬ h÷c ðßþc " .. x338000_g_TypeNames[skillBook.type] .. "." )
		return 0
	end

	if skillBook.needXinfa ~= -1 then
		local xinfaLevel = HaveXinFa( sceneId, selfId, skillBook.needXinfa )
		if xinfaLevel < 1 then
			x338000_NotifyFailTips( sceneId, selfId, "C¥n tâm pháp: #{_XINFA" .. skillBook.needXinfa .. "}." )
			return 0
		end

		if xinfaLevel < skillBook.needXinfaLevel then
			-- C¥n ²âÊÔÕâcáiµØ·½£¬¿çÐÐ¶øÇÒÃ»ÓÐ·ÖºÅ
			x338000_NotifyFailTips( sceneId, selfId, "C¥n tâm pháp: #{_XINFA" .. skillBook.needXinfa .. "} "
				.. skillBook.needXinfaLevel .. " , hi®n các hÕ ðang ðÕt " .. xinfaLevel .. " c¤p." )
			return 0
		end
	end

	if skillBook.type == 1 then					-- ÐÄ·¨
		if HaveXinFa( sceneId, selfId, skillBook.id ) > 0 then
			x338000_NotifyFailTips( sceneId, selfId, "Ngß½i ðã h÷c tâm pháp này." )
			return 0
		end
	elseif skillBook.type == 2 then				-- Yªu Quyªt
		if HaveSkill( sceneId, selfId, skillBook.id ) == 1 then
			x338000_NotifyFailTips( sceneId, selfId, "Ngß½i ðã h÷c kÛ nång này." )
			return 0
		end
	end

	return 1
end

--**********************************
--ÏûºÄ¼ì²â¼°´¦ÀíÈë¿Ú£¬¸ºÔðÏûºÄµÄ¼ì²âºÍÖ´ÐÐ: 
--·µ»Ø1: ÏûºÄ´¦ÀíÍ¨¹ý£¬¿ÉÒÔ¼ÌÐøÖ´ÐÐ£»·µ»Ø0: ÏûºÄ¼ì²âÊ§°Ü£¬ÖÐ¶ÏºóÐøÖ´ÐÐ.
--**********************************
function x338000_OnDeplete( sceneId, selfId )
	if LuaFnDepletingUsedItem( sceneId, selfId ) > 0 then
		return 1
	end

	return 0
end

--**********************************
--Ö»»áÖ´ÐÐÒ»´ÎÈë¿Ú: 
--¾ÛÆøºÍË²·¢¼¼ÄÜ»áTÕi ÏûºÄÍê³Éºóµ÷ÓÃÕâcái½Ó¿Ú(¾ÛÆø½áÊø²¢ÇÒ¸÷ÖÖÌõ¼þ¶¼Âú×ãµÄÊ±ºò)£¬¶øÒýµ¼
--¼¼ÄÜÒ²»áTÕi ÏûºÄÍê³Éºóµ÷ÓÃÕâcái½Ó¿Ú(¼¼ÄÜµÄÒ»¿ªÊ¼£¬ÏûºÄ³É¹¦Ö´ÐÐÖ®ºó).
--·µ»Ø1: ´¦Àí³É¹¦£»·µ»Ø0: ´¦ÀíÊ§°Ü.
--×¢: ÕâÀïÐúng¼¼ÄÜÉúÐ§Ò»´ÎµÄÈë¿Ú
--**********************************
function x338000_OnActivateOnce( sceneId, selfId )
	-- ÕÒµ½ÏàÓ¦ÌõÄ¿
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId )
	local skillBook = x338000_g_SkillBooks[itemTblIndex]
	if not skillBook then
		return 0
	end

	-- Ñ§Ï°
	if skillBook.type == 1 then					-- ÐÄ·¨
		if HaveXinFa( sceneId, selfId, skillBook.id ) > 0 then
			x338000_NotifyFailTips( sceneId, selfId, "Ngß½i ðã h÷c tâm pháp này." )
			return 0
		else
			AddXinFa( sceneId, selfId, skillBook.id )
		end
	elseif skillBook.type == 2 then				-- Yªu Quyªt
		if HaveSkill( sceneId, selfId, skillBook.id ) == 1 then
			x338000_NotifyFailTips( sceneId, selfId, "Ngß½i ðã h÷c kÛ nång này." )
			return 0
		else
			AddSkill( sceneId, selfId, skillBook.id )
		end
	end

	LuaFnSendSpecificImpactToUnit( sceneId, selfId, selfId, selfId, skillBook.specialEffectID, 0 )
	return 1
end

--**********************************
--Òýµ¼ÐÄÌø´¦ÀíÈë¿Ú: 
--Òýµ¼¼¼ÄÜ»áTÕi Ã¿´ÎÐÄÌø½áÊøÊ±µ÷ÓÃÕâcái½Ó¿Ú.
--·µ»Ø: 1¼ÌÐøÏÂ´ÎÐÄÌø£»0: ÖÐ¶ÏÒýµ¼.
--×¢: ÕâÀïÐúng¼¼ÄÜÐÄÌøÊ±ÉúÐ§µÄÈë¿Ú
--**********************************
function x338000_OnActivateEachTick( sceneId, selfId )
	return 1
end

--**********************************
-- ÐÑÄ¿Ê§°ÜÌáÊ¾
--**********************************
function x338000_NotifyFailTips( sceneId, selfId, Tip )
	BeginEvent( sceneId )
		AddText( sceneId, Tip )
	EndEvent( sceneId )
	DispatchMissionTips( sceneId, selfId )
end
